#include <ESP8266WiFi.h>
#include "TM1637DisplayAlnum.h"

  const int segments[] = {
    0, 0, 0, 0, 0, 0, 0, 0, // 0-7
    0, 0, 0, 0, 0, 0, 0, 0, // 8-15
    0, 0, 0, 0, 0, 0, 0, 0, // 16-23
    0, 0, 0, 0, 0, 0, 0, 0, // 24-31
    0, 0, 0, 0, 0, 0, 0, 0, // 32-39 (including 32=space)
    0, 0, 0, 0, 0,          // 40-44
    0b01000000,             // '-'
    0b10000000,             // '.'
    0,                      // '/'
    0b00111111,             // '0'
    0b00000110,             // '1'
    0b01011011,             // '2'
    0b01001111,             // '3'
    0b01100110,             // '4'
    0b01101101,             // '5'
    0b01111101,             // '6'
    0b00000111,             // '7'
    0b01111111,             // '8'
    0b01101111,             // '9'
    0, 0, 0, 
    0b01001000,             // '='
    0, 0, 0,
    0b01110111,             // 'A'
    0b01111100,             // 'B'
    0b00111001,             // 'C'
    0b01011110,             // 'D'
    0b01111001,             // 'E'
    0b01110001,             // 'F'
    0b01101111,             // 'G'
    0b01110110,             // 'H'
    0b00000110,             // 'I'
    0b00011110,             // 'J'
    0,                      // 'K'
    0b00111000,             // 'L'
    0,                      // 'M'
    0b00110111,             // 'N'
    0b00111111,             // 'O'
    0b01110011,             // 'P'
    0b01100111,             // 'Q'
    0b00110001,             // 'R'
    0b01101101,             // 'S'
    0b01111000,             // 'T'
    0b00111110,             // 'U'
    0,                      // 'V'
    0,                      // 'W'
    0,                      // 'X'
    0b01101110,             // 'Y'
    0,                      // 'Z'
    0, 0, 0, 0,
    0b00001000,             // '_'
    0,
    0b01110111,             // 'a'
    0b01111100,             // 'b'
    0b01011000,             // 'c'
    0b01011110,             // 'd'
    0b01111001,             // 'e'
    0b01110001,             // 'f'
    0b01101111,             // 'g'
    0b01110100,             // 'h'
    0b00000110,             // 'i'
    0b00011110,             // 'j'
    0,                      // 'k'
    0b00111000,             // 'l'
    0,                      // 'm'
    0b01010100,             // 'n'
    0b01011100,             // 'o'
    0b01110011,             // 'p'
    0b01100111,             // 'q'
    0b01010000,             // 'r'
    0b01101101,             // 's'
    0b01111000,             // 't'
    0b00011100,             // 'u'
    0,                      // 'v'
    0,                      // 'w'
    0,                      // 'x'
    0b01101110,             // 'y'
    0,                      // 'z'
  };

void TM1637DisplayAlnum::showAlnum(char c, uint8_t dots) {
  uint8_t segs[4];

  segs[0] = segments[c] | (dots? 0b10000000 : 0);
  for(int i=1; i<4; i++) {
    segs[i] = 0;
  }
  setSegments(segs);
}

void TM1637DisplayAlnum::showAlnum(const char s[], uint8_t dots) {
  uint8_t segs[4];

  for(int i=0; i<4 && s[i]; i++) {
    segs[i] = segments[s[i]] | (dots? 0b10000000 : 0);
  }
  setSegments(segs);
}